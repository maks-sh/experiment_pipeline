name: Average Revenue per Paying User Without Cancelation
type: ratio
estimator: mann_whitney_test
level: user_pseudo_id
numerator:
  aggregation_field: revenue
  aggregation_function: sum
numerator_condition: "pg_status == 'CANCELED'"
denominator:
  aggregation_field: user_pseudo_id
  aggregation_function: count_distinct
denominator_conditions: "event_name == 'purchase'"